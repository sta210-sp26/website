{
  "hash": "7677d65ef31ce5cbde1cd8b88ef8efea",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"SLR: Mathematical models for inference cont'd\"\nauthor: \"Prof. Maria Tackett\"\ndate: \"01-29-2026\"\ndate-format: \"MMMM DD, YYYY\"\nfooter: \"ðŸ”— [sta210-sp26.github.io](https://sta210-sp26.github.io)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs: \n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\n    include-before: [ '<script type=\"text/x-mathjax-config\">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>']\n  html: \n    output-file: 06-slr-math-models-contd-notes.html\nhtml-math-method:\n  method: mathjax\n  url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\"\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n\n## Announcements\n\n-   Lab 01 **due TODAY** at 11:59pm\n\n-   [Statistics experience](../hw/stats-experience.html) due April 21\n\n-   SSMU Mini DataFest - February 8\n\n    -   See [Ed Discussion](https://edstem.org/us/courses/91299/discussion/7577398) for announcement\n\n## Topics\n\n-   Use mathematical models to\n\n    -   conduct a hypothesis test for the slope\n\n    -   construct confidence intervals for the slope\n\n    -   construct intervals for predictions\n\n## Computational setup\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)   # for data wrangling and visualization\nlibrary(tidymodels)  # for modeling\nlibrary(openintro)   # for the duke_forest dataset\nlibrary(scales)      # for pretty axis labels\nlibrary(knitr)       # for pretty tables\nlibrary(kableExtra)  # also for pretty tables\nlibrary(patchwork)   # arrange plots\n\n# set default theme and larger font size for ggplot2\nggplot2::theme_set(ggplot2::theme_bw(base_size = 20))\n```\n:::\n\n\n# From last class\n\n## Mathematical representation of the model {.midi}\n\n$$\n\\begin{aligned}\nY &= \\text{Model} + \\text{Error} \\\\[8pt]\n&= f(X) + \\epsilon \\\\[8pt]\n&= E(Y|X) + \\epsilon \\\\[8pt]\n&= \\beta_0 + \\beta_1 X + \\epsilon\n\\end{aligned}\n$$\n\nwhere the errors are independent and normally distributed:\n\n-   **independent**: Knowing the error term for one observation doesn't tell you anything about the error term for another observation\n-   **normally distributed**: $\\epsilon \\sim N(0, \\sigma_\\epsilon^2)$\n\n## Mathematical representation, visualized {.midi}\n\n$$\nY|X \\sim N(\\beta_0 + \\beta_1 X, \\sigma_\\epsilon^2)\n$$\n\n::::: columns\n::: {.column width=\"70%\"}\n![Image source: *Introduction to the Practice of Statistics (5th ed)*](images/05/regression.png)\n:::\n\n::: {.column width=\"30%\"}\n-   Mean: $\\beta_0 + \\beta_1 X$, the predicted value based on the regression model\n-   Variance: $\\sigma_\\epsilon^2$, constant across the range of $X$\n    -   How do we estimate $\\sigma_\\epsilon^2$?\n:::\n:::::\n\n## Regression standard error\n\nOnce we fit the model, we can use the residuals to estimate the **regression standard error**, the average distance between the observed values and the regression line\n\n$$\n\\hat{\\sigma}_\\epsilon = \\sqrt{\\frac{\\sum_\\limits{i=1}^n(y_i - \\hat{y}_i)^2}{n-2}} = \\sqrt{\\frac{\\sum_\\limits{i=1}^ne_i^2}{n-2}}\n$$\n\n## Standard error of $\\hat{\\beta}_1$\n\nThe **standard error of** $\\hat{\\beta}_1$ quantifies the sampling variability in the estimated slopes\n\n$$\nSE_{\\hat{\\beta}_1} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{(n-1)s_X^2}}\n$$\n\n. . .\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 116652.33 </td>\n   <td style=\"text-align:right;\"> 53302.46 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> area </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 159.48 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 18.17 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 8.78 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Mathematical models for inference for $\\beta_1$\n\n## Hypothesis test for $\\beta_1$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 116652.33 </td>\n   <td style=\"text-align:right;\"> 53302.46 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> area </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 159.48 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 18.17 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 8.78 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n$$\nH_0: \\beta_1 = 0 \\hspace{2mm} \\text{ vs }\\hspace{2mm} \\beta_1 \\neq 0\n$$\n\n## Hypothesis test for $\\beta_1$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 116652.33 </td>\n   <td style=\"text-align:right;\"> 53302.46 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> area </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 159.48 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 18.17 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 8.78 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n$$\nT = \\frac{\\hat{\\beta}_1 - 0}{SE_{\\hat{\\beta}_1}} = \\frac{159.48 - 0}{18.17} = 8.78\n$$\n\n. . .\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n2 * pt(q = 8.78, df = 96, lower.tail = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.19602e-14\n```\n\n\n:::\n:::\n\n\n## Hypothesis test for $\\beta_1$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 116652.33 </td>\n   <td style=\"text-align:right;\"> 53302.46 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> area </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 159.48 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 18.17 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 8.78 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n<br>\n\n-   The data provide convincing evidence that the population slope $\\beta_1$ is different from 0.\n-   The data provide convincing evidence of a linear relationship between area and price of houses in Duke Forest.\n\n# Confidence intervals\n\n## Confidence interval for the slope\n\n$$\n\\text{Estimate} \\pm \\text{ (critical value) } \\times \\text{SE}\n$$\n\n. . .\n\n$$\n\\hat{\\beta}_1 \\pm t^* \\times SE_{\\hat{\\beta}_1}\n$$\n\nwhere $t^*$ is calculated from a $t$ distribution with $n-2$ degrees of freedom\n\n## Confidence interval: Critical value\n\n:::::::: columns\n:::::: {.column width=\"60%\"}\n::: {.fragment fragment-index=\"1\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# confidence level: 95%\nqt(0.975, df = nrow(duke_forest) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.984984\n```\n\n\n:::\n:::\n\n:::\n\n::: {.fragment fragment-index=\"2\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# confidence level: 90%\nqt(0.95, df = nrow(duke_forest) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.660881\n```\n\n\n:::\n:::\n\n:::\n\n::: {.fragment fragment-index=\"3\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# confidence level: 99%\nqt(0.995, df = nrow(duke_forest) - 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.628016\n```\n\n\n:::\n:::\n\n:::\n::::::\n\n::: {.column width=\"40%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slr-math-models-contd_files/figure-revealjs/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n:::\n::::::::\n\n## 95% CI for the slope: Calculation\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 116652.33 </td>\n   <td style=\"text-align:right;\"> 53302.46 </td>\n   <td style=\"text-align:right;\"> 2.19 </td>\n   <td style=\"text-align:right;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(217, 227, 228, 255) !important;\"> area </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 159.48 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 18.17 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 8.78 </td>\n   <td style=\"text-align:right;background-color: rgba(217, 227, 228, 255) !important;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n$$\\hat{\\beta}_1 = 159.48 \\hspace{15mm} t^* = 1.98 \\hspace{15mm} SE_{\\hat{\\beta}_1} = 18.17$$\n\n. . .\n\n$$\n159.48 \\pm 1.98 \\times 18.17 = (123.50, 195.46)\n$$\n\n## 95% CI for the slope: Computation\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntidy(df_fit, conf.int = TRUE, conf.level = 0.95) |> \n  kable(digits = 2)\n```\n\n::: {.cell-output-display}\n\n\n|term        |  estimate| std.error| statistic| p.value| conf.low| conf.high|\n|:-----------|---------:|---------:|---------:|-------:|--------:|---------:|\n|(Intercept) | 116652.33|  53302.46|      2.19|    0.03| 10847.77| 222456.88|\n|area        |    159.48|     18.17|      8.78|    0.00|   123.41|    195.55|\n\n\n:::\n:::\n\n\n# Intervals for predictions\n\n## Intervals for predictions {.midi}\n\n-   Suppose we want to answer the question *\"What is the predicted sale price of a Duke Forest house that is 2,800 square feet?\"*\n-   We said reporting a single estimate for the slope is not wise, and we should report a plausible range instead\n-   Similarly, reporting a single prediction for a new value is not wise, and we should report a plausible range instead\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slr-math-models-contd_files/figure-revealjs/unnamed-chunk-12-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## Two types of predictions\n\n1.  Prediction for the mean: \"What is the average predicted sale price of Duke Forest houses that are 2,800 square feet?\"\n\n2.  Prediction for an individual observation: \"What is the predicted sale price of a Duke Forest house that is 2,800 square feet?\"\n\n. . .\n\n::: question\n-   Which would you expect to be more variable? The average prediction or the prediction for an individual observation?\n\n-   Based on your answer, how would you expect the widths of plausible ranges for these two predictions to compare?\n:::\n\n## Uncertainty in predictions\n\n**Confidence interval for the mean outcome:** $$\\large{\\hat{y} \\pm t_{n-2}^* \\times \\color{purple}{\\mathbf{SE}_{\\hat{\\boldsymbol{\\mu}}}}}$$\n\n. . .\n\n**Prediction interval for an individual observation:** $$\\large{\\hat{y} \\pm t_{n-2}^* \\times \\color{purple}{\\mathbf{SE_{\\hat{y}}}}}$$\n\n## Standard errors\n\n**Standard error of the mean outcome:** $$SE_{\\hat{\\mu}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n. . .\n\n**Standard error of an individual outcome:** $$SE_{\\hat{y}} = \\hat{\\sigma}_\\epsilon\\sqrt{1 + \\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n## Standard errors\n\n**Standard error of the mean outcome:** $$SE_{\\hat{\\mu}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n**Standard error of an individual outcome:** $$SE_{\\hat{y}} = \\hat{\\sigma}_\\epsilon\\sqrt{\\mathbf{\\color{purple}{\\Large{1}}} + \\frac{1}{n} + \\frac{(x-\\bar{x})^2}{\\sum\\limits_{i=1}^n(x_i - \\bar{x})^2}}$$\n\n## Confidence interval\n\nThe 95% **confidence interval** for the *mean* outcome:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnew_house <- tibble(area = 2800)\n\npredict(df_fit, new_house, interval = \"confidence\", level = 0.95) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|      fit|    lwr|      upr|\n|--------:|------:|--------:|\n| 563205.5| 529351| 597060.1|\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n. . .\n\nWe are 95% confident that mean sale price of Duke Forest houses that are 2,800 square feet is between $529,351 and $597,060.\n\n## Prediction interval\n\nThe 95% **prediction interval** for an *individual* outcome:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnew_house <- tibble(area = 2800)\n\npredict(df_fit, new_house, interval = \"prediction\", level = 0.95) |>\n  kable()\n```\n\n::: {.cell-output-display}\n\n\n|      fit|      lwr|      upr|\n|--------:|--------:|--------:|\n| 563205.5| 226438.3| 899972.7|\n\n\n:::\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n. . .\n\nWe are 95% confident that predicted sale price of a Duke Forest house that is 2,800 square feet is between $226,438 and $899,973.\n\n## Comparing intervals\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-slr-math-models-contd_files/figure-revealjs/unnamed-chunk-17-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Extrapolation\n\nUsing the model to predict for values outside the range of the original data is **extrapolation**.\n\n. . .\n\n:::::: columns\n:::: {.column width=\"45%\"}\n::: question\nCalculate the prediction interval for the sale price of a \"tiny house\" in Duke Forest that is 225 square feet.\n:::\n::::\n\n::: {.column width=\"55%\"}\n![](images/06/tiny-house.jpeg){fig-alt=\"Black tiny house on wheels\" fig-align=\"center\"}\n:::\n::::::\n\n. . .\n\n*No, thanks!*\n\n## Recap\n\n-   Defined mathematical models to conduct inference for the slope\n\n-   Used mathematical models to\n\n    -   calculate confidence interval for the slope\n\n    -   conduct a hypothesis test for the slope\n\n    -   construct intervals for predictions\n",
    "supporting": [
      "06-slr-math-models-contd_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}