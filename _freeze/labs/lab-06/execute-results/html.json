{
  "hash": "9d4848e12c51802e19bab1ff2321a770",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 06: Multinomial logistic regression\"\nexecute:\n  freeze: auto\n  echo: false\n  warning: false\n  message: false\nformat: html\nbibliography: references.bib\n---\n\n::: callout-important\n# Due date\n\nThis lab is due on **Tuesday, April 15 11:59pm.** To be considered on time, the following must be done by the due date:\n\n-   Final `.qmd` and `.pdf` files pushed to your team's GitHub repo\n-   Final `.pdf` file submitted on Gradescope\n:::\n\n# Multinomial logistic regression\n\nIn this lab, you will use multinomial logistic regression to understand how different conditions of a crime and suspect lineup impact individuals' ability to correctly identify the perpetrator. You will also use cross validation to compare and evaluate candidate models. The data are from a mock crime scenario in a 2014 experiment.\n\n# Learning goals\n\nBy the end of the lab you will be able to…\n\n-   interpret visualizations in the exploratory data analysis for multinomial logistic regression.\n\n-   fit and interpret multinomial logistic regression model.\n\n-   use cross validation to fit and compare models.\n\n# Packages\n\nFill in the packages you need to complete the assignment in your R Markdown document.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(knitr)\nlibrary(nnet)\n\n# Include other packages as needed\n```\n:::\n\n\n# Data\n\nFor this assignment, we will analyze data from the eye witness identification experiment in @carlson2014evaluation. In this experiment, participants were asked to watch a video of a mock crime (from the first person perspective), spend a few minutes completing a random task, and then identify the perpetrator of the mock crime from a line up shown on the screen. Every lineup in this analysis included the true perpetrator from the video. After viewing the line-up , each participant was asked to make a decision. This decision is the **response variable**\n\n-   `id`: Decision made by participant. It takes one of the following values:\n\n    -   `correct`: correctly identified the true perpetrator\n\n    -   `foil`: incorrectly identified the \"foil\", i.e. a person who looks very similar to the perpetrator\n\n    -   `reject`: incorrectly concluded the true perpetrator is not in the lineup\n\nThe main objective of the analysis is to understand how different conditions of the mock crime and suspect lineup affect the decision made by the participant. We will consider the following conditions to describe the decisions. These are the **predictor variables**:\n\n-   `lineup`: How potential suspects are shown to the participants\n    -   `Simultaneous Lineup`: Participants were shown photos of all 6 potential suspects at the same time and were required to make a single decision (identify someone from the lineup or reject the lineup).\n    -   `Sequential 5 Lineup`: Photos of the 6 suspects were shown one at a time. The participant was required to make a decision (choose or don't choose) as each photo was shown. Once a decision was made, participants were not allowed to reexamine a photo. If the participant made an identification, the remaining photos were not shown. In each of these lineups the true perpetrator was always the 5<sup>th</sup> photo in the lineup.\n-   `weapon`: Whether or not a weapon was present in the video of the mock crime.\n-   `feature`: Whether or not the perpetrator had a distinctive marking on his face. In this experiment, the distinctive feature was a large \"N\" sticker on one cheek. (The letter \"N\" was chosen to represent the first author's alma mater - University of Nebraska.)\n\n<br>\n\nThe data may be found in `eyewitness.csv` in the `data` folder.\n\n# Exercises\n\n## Exercise 1\n\nLet's begin by doing the exploratory data analysis. Univariate and bivariate plots are shown below.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](lab-06_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](lab-06_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\na.  Write two observations from the univariate EDA.\nb.  Write two observations from the bivariate EDA.\n\n## Exercise 2\n\nMake all the variables factor variable types. Then, split the data into training (75%) and test (25%) sets. Use seed `210`.\n\nHow many observations are in the training set?\n\n## Exercise 3\n\na.  Briefly explain a multinomial logistic regression model is an appropriate model choice for predicting `id` using `lineup`, `weapon` and `feature`.\nb.  Use the training data to fit a multinomial logistic model using only the main effects for `lineup` , `weapon`, and `feature`. Neatly display the model using 3 digits.\n\n## Exercise 4\n\na.  What is the baseline category for the response variable?\nb.  What experimental conditions are described by the intercept?\nc.  Interpret the coefficients of `lineup` for each part of the model in terms of the odds.\nd.  Use the coefficients and inferential statistics to describe the association between `lineup` and `id`.\n\n## Exercise 5\n\nYou are considering a model that includes all possible interactions between the predictors `lineup` , `weapon`, and `feature` . You will use 5-fold cross validation to choose between the main effects model fit in Exercise 3 and the model with interaction effects.\n\n::: callout-tip\nSee [Cross Validation](https://sta210-sp25.netlify.app/slides/23-cross-validation#/title-slide) notes for relevant code.\n:::\n\na.  Use the training data and seed `210` to create 5 folds. How many observations are in the assessment set for each fold?\nb.  Fit the main effects model on the 5 folds.\nc.  What is the average accuracy across all folds? What is the average AUC?\n\n## Exercise 6\n\na.  Fit the interaction model on the 5 folds from the previous exercise.\nb.  What is the average accuracy across all folds? What is the average AUC?\nc.  Based on the cross validation results, do you choose the main effects model or the model with interactions? Briefly explain your response.\n\n## Exercise 7\n\nIf needed, fit the model selected in the previous exercise on the full training data.\n\nNext, use the testing data to predict the classes of `id`, and make a confusion matrix of the actual versus predicted classes of `id`.\n\nLastly, use the confusion matrix to comment on the model performance.\n\n::: callout-tip\nBelow is template code to compute predicted classes on a test set:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npred_class <- predict(model_name, test_set, type = \"class\")\n```\n:::\n\n\nSee [Multinomial Logistic Regression: Inference + Prediction](https://sta210-sp25.netlify.app/slides/22-multinomial-pt2#/title-slide) notes for additional help with code.\n:::\n\n# Submission\n\nSubmit your completed assignment as a **PDF** to Gradescope. Follow the instructions carefully to ensure your submission is complete.\n\n::: callout-warning\nBefore you wrap up the assignment, make sure all documents are updated on your GitHub repo. We will be checking these to make sure you have been practicing how to commit and push changes.\n\nRemember – you must turn in a PDF file to the Gradescope page before the submission deadline for full credit.\n:::\n\nTo submit your assignment:\n\n-   Access Gradescope through the [STA 210 Canvas site](https://canvas.duke.edu/courses/47067).\n\n-   Click on the assignment, and you’ll be prompted to submit it.\n\n-   Select all team members’ names, so they receive credit on the assignment. [Click here](https://help.gradescope.com/article/m5qz2xsnjy-student-add-group-members) for video on adding team members to assignment on Gradescope.\n\n-   Mark the pages associated with each exercise. All of the pages of your lab should be associated with at least one question (i.e., should be “checked”).\n\n-   Select the first page of your .PDF submission to be associated with the *“Workflow & formatting”* section.\n\n# Grading\n\n| Component             | **Points** |\n|-----------------------|:----------:|\n| Exercise 1            |     4      |\n| Exercise 2            |     4      |\n| Exercise 3            |     4      |\n| Exercise 4            |     10     |\n| Exercise 5            |     8      |\n| Exercise 6            |     6      |\n| Exercise 7            |     9      |\n| Workflow & formatting |     5      |\n| **Total**             |   **50**   |\n\nThe “Workflow & formatting” grade is to assess the reproducible workflow and collaboration. This includes having at least one meaningful commit from each team member, a neatly organized document with readable code, and updating the team name and date in the YAML.\n\n# References\n",
    "supporting": [
      "lab-06_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}