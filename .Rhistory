geom_sf(aes(fill = mc_toddler), color = NA) +
scale_fill_viridis_c(na.value = "grey90") +
coord_sf(
xlim = c(-125, -66),
ylim = c(24, 50),
expand = FALSE)  +
labs(title = "Median weekly preschool costs",
subtitle = "in United States 600 counties",
fill = "Median cost") +
theme_void()
#| echo: false
county_map
#| include: false
library(countdown)
library(tidyverse)
library(tidymodels)
library(knitr)
knitr::opts_chunk$set(
fig.width = 8,
fig.asp = 0.618,
fig.retina = 3,
dpi = 300,
out.width = "80%",
fig.align = "center"
)
ggplot2::theme_set(ggplot2::theme_bw(base_size = 16))
#| echo: true
#| message: false
# load packages
library(tidyverse)   # for data wrangling and visualization
library(tidymodels)  # for modeling
library(openintro)   # for Duke Forest dataset
library(scales)      # for pretty axis labels
library(glue)        # for constructing character strings
library(knitr)       # for neatly formatted tables
library(kableExtra)  # also for neatly formatted tablesf
# set default theme and larger font size for ggplot2
ggplot2::theme_set(ggplot2::theme_bw(base_size = 16))
#| code-fold: true
ggplot(duke_forest, aes(x = area, y = price)) +
geom_point(alpha = 0.7) +
labs(
x = "Area (square feet)",
y = "Sales price (USD)",
title = "Price and area of houses in Duke Forest"
) +
scale_y_continuous(labels = label_dollar())
#| echo: true
df_fit <- lm(price ~ area, data = duke_forest)
tidy(df_fit) |>
kable(digits = 2) #neatly format table to 2 digits
#| echo: false
intercept <- tidy(df_fit) |> filter(term == "(Intercept)") |> pull(estimate) |> round()
slope <- tidy(df_fit) |> filter(term == "area") |> pull(estimate) |> round()
#| echo: false
set.seed(119)
df_boot_samples_5 <- duke_forest |>
specify(price ~ area) |>
generate(reps = 5, type = "bootstrap")
#| echo: false
#| out.width: "100%"
p_df_obs <- ggplot(duke_forest, aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "#8F2D56") +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = "Price and area of houses in Duke Forest"
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 1
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 2
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 3
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 4
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 5
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
ggplot(df_boot_samples_5, aes(x = area, y = price, group = replicate)) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.5) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap samples 1 - 5")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
set.seed(119)
df_boot_samples_100 <- duke_forest |>
specify(price ~ area) |>
generate(reps = 100, type = "bootstrap")
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
p_df_boot_samples_100 <- ggplot(df_boot_samples_100, aes(x = area, y = price, group = replicate)) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.05) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap samples 1 - 100")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
p_df_boot_samples_100
#| echo: false
p_df_boot_samples_100 +
geom_abline(intercept = intercept, slope = slope, color = "#8F2D56")
corr(duke_forest$price, duke_forest$area)
cor(duke_forest$price, duke_forest$area)
tidy(df_fit)
mean(duke_forest$area)
round(sd(df_boot_samples_1000_fit |> filter(term == "area"), 3)
)
round(sd(df_boot_samples_1000_fit |> filter(term == "area")), 3)
#| include: false
library(countdown)
library(tidyverse)
library(tidymodels)
library(knitr)
knitr::opts_chunk$set(
fig.width = 8,
fig.asp = 0.618,
fig.retina = 3,
dpi = 300,
out.width = "80%",
fig.align = "center"
)
ggplot2::theme_set(ggplot2::theme_bw(base_size = 16))
#| echo: true
#| message: false
# load packages
library(tidyverse)   # for data wrangling and visualization
library(tidymodels)  # for modeling
library(openintro)   # for Duke Forest dataset
library(scales)      # for pretty axis labels
library(glue)        # for constructing character strings
library(knitr)       # for neatly formatted tables
library(kableExtra)  # also for neatly formatted tablesf
# set default theme and larger font size for ggplot2
ggplot2::theme_set(ggplot2::theme_bw(base_size = 16))
#| code-fold: true
ggplot(duke_forest, aes(x = area, y = price)) +
geom_point(alpha = 0.7) +
labs(
x = "Area (square feet)",
y = "Sales price (USD)",
title = "Price and area of houses in Duke Forest"
) +
scale_y_continuous(labels = label_dollar())
#| echo: true
df_fit <- lm(price ~ area, data = duke_forest)
tidy(df_fit) |>
kable(digits = 2) #neatly format table to 2 digits
#| echo: false
intercept <- tidy(df_fit) |> filter(term == "(Intercept)") |> pull(estimate) |> round()
slope <- tidy(df_fit) |> filter(term == "area") |> pull(estimate) |> round()
#| echo: false
set.seed(119)
df_boot_samples_5 <- duke_forest |>
specify(price ~ area) |>
generate(reps = 5, type = "bootstrap")
#| echo: false
#| out.width: "100%"
p_df_obs <- ggplot(duke_forest, aes(x = area, y = price)) +
geom_point() +
geom_smooth(method = "lm", se = FALSE, color = "#8F2D56") +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = "Price and area of houses in Duke Forest"
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 1
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 2
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 3
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 4
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
replicate_no = 5
ggplot(df_boot_samples_5 |> filter(replicate == replicate_no),
aes(x = area, y = price)) +
geom_point(alpha = 0.5) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.8) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap sample {replicate_no}")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
ggplot(df_boot_samples_5, aes(x = area, y = price, group = replicate)) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.5) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap samples 1 - 5")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
#| echo: false
set.seed(119)
df_boot_samples_100 <- duke_forest |>
specify(price ~ area) |>
generate(reps = 100, type = "bootstrap")
#| echo: false
#| out.width: "100%"
p_df_obs
#| echo: false
#| out.width: "100%"
p_df_boot_samples_100 <- ggplot(df_boot_samples_100, aes(x = area, y = price, group = replicate)) +
geom_line(stat = "smooth", method = "lm", se = FALSE, alpha = 0.05) +
labs(
x = "Area (square feet)",
y = "sales price (USD)",
title = glue("Bootstrap samples 1 - 100")
) +
scale_x_continuous(labels = label_number(), limits = c(1000, 6500)) +
scale_y_continuous(labels = label_dollar(), limits = c(90000, 1550000))
p_df_boot_samples_100
#| echo: false
p_df_boot_samples_100 +
geom_abline(intercept = intercept, slope = slope, color = "#8F2D56")
#| echo: false
df_boot_samples_100_fit <- df_boot_samples_100 |>
fit()
df_boot_samples_100_hist <- ggplot(df_boot_samples_100_fit |> filter(term == "area"), aes(x = estimate)) +
geom_histogram(binwidth = 10, color = "white") +
geom_vline(xintercept = slope, color = "#8F2D56", size = 1) +
labs(x = "Slope", y = "Count",
title = "Slopes of 100 bootstrap samples") +
scale_x_continuous(labels = label_dollar())
df_boot_samples_100_hist
#| echo: false
set.seed(119)
df_boot_samples_1000 <- duke_forest |>
specify(price ~ area) |>
generate(reps = 1000, type = "bootstrap")
df_boot_samples_1000_fit <- df_boot_samples_1000 |>
fit()
df_boot_samples_1000_hist <- ggplot(df_boot_samples_1000_fit |> filter(term == "area"), aes(x = estimate)) +
geom_histogram(binwidth = 10, color = "white") +
geom_vline(xintercept = slope, color = "#8F2D56", size = 1) +
labs(x = "Slope", y = "Count",
title = "Bootstrap sampling distribution",
subtitle = "1000 bootstrap samples") +
scale_x_continuous(labels = label_dollar())
df_boot_samples_1000_hist
round(sd(df_boot_samples_1000_fit |> filter(term == "area")), 3)
df_boot_samples_1000_fit
df_boot_samples_1000_fit  |> filter(term == "area") |> sd()
df_boot_samples_1000_fit  |> filter(term == "area") |>
/
df_boot_samples_1000_fit |> ungroup |> filter(term == "area") |> sd(estimate
)
df_boot_samples_1000_fit |> ungroup |> filter(term == "area") |> summarise(sd(estimate)) |> pull()
df_boot_samples_1000_fit |> ungroup() |> filter(term == "area") |> summarise(sd(estimate)) |> pull()
#| include: false
library(countdown)
knitr::opts_chunk$set(
fig.width = 8,
fig.asp = 0.618,
fig.retina = 3,
dpi = 300,
out.width = "80%",
fig.align = "center"
)
#| echo: true
#| message: false
# load packages
library(tidyverse)   # for data wrangling and visualization
library(tidymodels)  # for modeling
library(usdata)      # for the county_2019 dataset
library(openintro)   # for Duke Forest dataset
library(scales)      # for pretty axis labels
library(glue)        # for constructing character strings
library(knitr)       # for neatly formatted tables
library(kableExtra)  # also for neatly formatted tablesf
# set default theme and larger font size for ggplot2
ggplot2::theme_set(ggplot2::theme_bw(base_size = 16))
#| echo: false
ggplot(duke_forest, aes(x = area, y = price)) +
geom_point(alpha = 0.7) +
labs(
x = "Area (square feet)",
y = "Sale price (USD)",
title = "Price and area of houses in Duke Forest"
) +
scale_y_continuous(labels = label_dollar()) +
scale_x_continuous(labels = label_number())
df_fit <- lm(price ~ area, data = duke_forest)
tidy(df_fit) |>
kable(digits = 2)
#| echo: false
intercept <- tidy(df_fit) |> filter(term == "(Intercept)") |> pull(estimate) |> round()
slope <- tidy(df_fit) |> filter(term == "area") |> pull(estimate) |> round()
#| echo: true
#| code-line-numbers: "|1|3|4"
set.seed(210)
duke_forest |>
specify(price ~ area)
#| echo: true
#| code-line-numbers: "|5"
set.seed(210)
duke_forest |>
specify(price ~ area) |>
generate(reps = 1000, type = "bootstrap")
#| echo: true
#| code-line-numbers: "|6"
set.seed(210)
duke_forest |>
specify(price ~ area) |>
generate(reps = 1000, type = "bootstrap") |>
fit()
#| echo: true
#| code-line-numbers: "|3"
set.seed(210)
boot_dist <- duke_forest |>
specify(price ~ area) |>
generate(reps = 1000, type = "bootstrap") |>
fit()
#| echo: true
#| code-line-numbers: "|2"
boot_dist |>
filter(term == "area") |>
ggplot(aes(x = estimate)) +
geom_histogram(binwidth = 10)
#| echo: false
boot_dist |>
filter(term == "area") |>
ggplot(aes(x = estimate)) +
geom_histogram(binwidth = 10)
#| echo: true
boot_dist |>
get_confidence_interval(
# point_estimate = obs_fit,
level = 0.95
# type = "percentile"
)
#| echo: true
boot_dist |>
get_confidence_interval(
point_estimate = obs_fit,
level = 0.95
# type = "percentile"
)
#| echo: true
obs_fit <- duke_forest |>
specify(price ~ area) |>
fit()
obs_fit
#| echo: true
boot_dist |>
get_confidence_interval(
point_estimate = obs_fit,
level = 0.95,
type = "percentile"
)
